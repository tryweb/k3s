# LibreNMS Helm Chart Values
# 此檔案由 Git 管理，透過 Rancher Fleet 自動部署
# 官方 Chart: https://github.com/librenms/helm-charts
#
# ⚠️  敏感資訊（密碼、密鑰）請使用 Kubernetes Secret 管理
#     請參閱 README.md 的「敏感資訊管理」章節

# LibreNMS 核心配置
librenms:
  # 應用程式密鑰
  # 注意：此值會被 existingSecret 覆蓋，但 chart schema 要求必須提供字串值
  appkey: "placeholder-will-be-overridden-by-secret"
  # 實際密鑰從 Secret 載入（需要先建立 Secret: librenms-app-secret）
  # Secret 中必須包含 key 名為 "appkey" 的資料
  existingSecret: librenms-app-secret
  
  # Frontend 配置
  frontend:
    replicas: 1
    # 資源配置 - 先不設限制，讓 Pod 能啟動
    # 待運行穩定後，根據 kubectl top pods 實際使用量調整
    resources: {}
      # requests:
      #   memory: "256Mi"
      #   cpu: "100m"
      # limits:
      #   memory: "1Gi"
      #   cpu: "500m"

# 持久化存儲
persistence:
  enabled: true
  storageClass: "nfs-client"  # 使用 NFS StorageClass
  size: 5Gi

# 資料庫配置 (內建 MySQL - Bitnami chart)
# 密碼使用 existingSecret 引用，不存放在 Git 中
mysql:
  enabled: true
  auth:
    database: librenms
    username: librenms
    # 使用預先建立的 Secret
    # Secret 必須包含 key: mysql-root-password, mysql-password
    existingSecret: librenms-mysql-secret
  primary:
    persistence:
      enabled: true
      storageClass: "nfs-client"  # 使用 NFS StorageClass
      size: 10Gi

# Redis 配置
# 密碼使用 existingSecret 引用，不存放在 Git 中
redis:
  enabled: true
  auth:
    enabled: true
    existingSecret: librenms-redis-secret
    existingSecretPasswordKey: redis-password
  master:
    persistence:
      storageClass: "nfs-client"  # 使用 NFS StorageClass

# Ingress 配置
ingress:
  enabled: true
  className: "nginx"
  annotations:
    kubernetes.io/ingress.class: "nginx"
    nginx.ingress.kubernetes.io/proxy-body-size: "64m"
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
  hosts:
    - host: nms.k3s.ichiayi.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: wildcard-k3s-ichiayi-com-tls
      hosts:
        - nms.k3s.ichiayi.com

# 服務配置
service:
  type: ClusterIP
  port: 80

# SNMP 配置
snmp:
  community: "public"

# 環境變數
env: {}

# 額外的環境變數從 Secret 載入
envFrom: []

# 副本數
replicaCount: 1

# 節點選擇器
nodeSelector: {}

# 容忍度
tolerations: []

# 親和性
affinity: {}